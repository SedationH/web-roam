以问题作为标题

碎片化记录遇到的问题

为体系化整理提供资料



## When working with text nodes should I use the “data”, “nodeValue”, “textContent” or “wholeText” field? | innerHTML innerText 

![image-20201109172822380](http://picbed.sedationh.cn/image-20201109172822380.png)

在获取的Text文本内容中，貌似都是一样的

> Of all these I'd choose data: it is defined for the nodes implementing CharacterData interface (Text and Comment ones) only. Trying to access this property for the others gives undefined.
>
> nodeValue is essentially the same as data for text nodes, but is actually defined for attribute and comment nodes as well. And I usually want my programs to fail early. )
>
> textContent is, for me, something completely different, as it represents the text content of a node and its descendants. This, along with wholeText, perhaps should be used more to collect texts from more complex structures than a single text node.
>
> Said all that, textContent and wholeText were defined in DOM Level 3 (= more modern).

单独的文本节点处理 使用nodeValue就好,效果合适，最小依赖使用

| Node                                                         | Value of nodeValue                  |
| :----------------------------------------------------------- | :---------------------------------- |
| [`CDATASection`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/CDATASection.html) | Content of the CDATA section        |
| [`Comment`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Comment.html) | Content of the comment              |
| [`Document`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Document.html) | `null`                              |
| [`DocumentFragment`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/DocumentFragment.html) | `null`                              |
| [`DocumentType`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/DocumentType.html) | `null`                              |
| [`Element`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Element.html) | `null`                              |
| [`NamedNodeMap`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap.html) | `null`                              |
| `EntityReference`                                            | `null`                              |
| [`Notation`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Notation.html) | `null`                              |
| [`ProcessingInstruction`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/ProcessingInstruction.html) | Entire content excluding the target |
| [`Text`](dfile:///Users/sedationh/Library/Application Support/Dash/DocSets/JavaScript/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Text.html) | Content of the text node            |



Text.wholeText 包含临近的Text nodes

> The **`Text.wholeText`** read-only property returns the full text of all [`Text`](https://developer.mozilla.org/en-US/docs/Web/API/Text) nodes logically adjacent to the node. The text is concatenated in document order. This allows to specify any text node and obtain all adjacent text as a single string.



Given this HTML fragment:

```html
<div id="divA">This is <span>some</span> text!</div>
```

... you can use `textContent` to get the element's text content:

```js
let text = document.getElementById('divA').textContent;
// The text variable is now: 'This is some text!'
```

... or set the element's text content:

```js
document.getElementById('divA').textContent = 'This text is different!';
// The HTML for divA is now:
// <div id="divA">This text is different!</div>
```



另外，看看jq对Text的处理

https://api.jquery.com/text/



## onload & DOMContentLoaded

[再谈 load 与 DOMContentLoaded](https://juejin.im/post/6844903623583891469#heading-1)

[JavaScript 是如何影响 DOM 生成的](https://blog.poetries.top/browser-working-principle/guide/part5/lesson22.html#javascript-%E6%98%AF%E5%A6%82%E4%BD%95%E5%BD%B1%E5%93%8D-dom-%E7%94%9F%E6%88%90%E7%9A%84)

重点理解

![image-20201117100639181](http://picbed.sedationh.cn/image-20201117100639181.png)

整体逻辑并不复杂，需要先理清几个理解前提

1. 下载和解析是并行的，浏览器有与之对应的网络进程和渲染进程
2. 页面的渲染，简单理解为页面上有东西了。这个过程需要DOM和CSSOM共同配合才能显示出来。
3. js的执行，依赖于DOM & CSSOM，why？ 因为js能够操作他们

如果 script 没有 defer || async 那么就是等待script下载完成，并且CSSOM要构建好(link下载完成)



DOMContentLoaded 的时机就是**html文档加载完毕，并且 html 所引用的内联 js、以及外链 js 的同步代码都执行完毕后触发**。



load当页面 DOM 结构中的 js、css、图片，以及 js 异步加载的 js、css 、图片都加载完成之后，才会触发 load 事件。

注意：

- 页面中引用的js 代码如果有异步加载的 js、css、图片，是会影响 load 事件触发的。
- video、audio、flash 不会影响 load 事件触发。



## [Converting Strings to Number in Javascript: Pitfalls](https://coderwall.com/p/5tlhmw/converting-strings-to-number-in-javascript-pitfalls)

如果字符有含有数字不应该有的 -> NaN

```js
+ '1.3'
```

就好



文章中还有很多讨论了十六进制数字和各种特殊情况处理，最终考虑速度



## [MVC、MVP、MVVM](https://g.yuque.com/sunluyong/node/mvc)



## 关于type conver  ,refer specifications

https://www.ecma-international.org/ecma-262/5.1/#sec-11.9.3

感觉看别人说来说去，其实规范里说的很清晰