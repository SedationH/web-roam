## var let const

### **Hoisting**

åœ¨ä½¿ç”¨var å’Œ å‡½æ•°å£°æ˜çš„æ—¶å€™éƒ½ä¼šå‘ç”Ÿ**Hoisting**ï¼ˆå˜é‡æå‡ï¼‰

Hoisting was thought up as a general way of thinking about how **execution contexts** (specifically the creation and execution phases) work in JavaScript. 



One of the advantages of JavaScript putting function declarations into memory before it executes any code segment is that it allows you to use a function before you declare it in your code. For example:

```js
catName("Chloe");

function catName(name) {
  console.log("My cat's name is " + name);
}
/*
The result of the code above is: "My cat's name is Chloe"
*/
```

JavaScript only hoists declarations, not initializations. If a variable is declared and initialized after using it, the value will be undefined. For example:

```js
console.log(num); // Returns undefined, as only declaration was hoisted, no initialization has happened at this stage 
var num; // declaration
num = 6; // initialization
```



### å…³äºå‡½æ•°åˆ›å»º

A function expression is very similar to and has almost the same syntax as a function declaration (see [`function statement`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function) for details). The main difference between a function expression and a function declaration is the *function name*, which can be omitted in function expressions to create *anonymous* functions. A function expression can be used as an [IIFE (Immediately Invoked Function Expression)](https://developer.mozilla.org/en-US/docs/Glossary/IIFE) which runs as soon as it is defined. 

### å…³äºä¼˜å…ˆçº§

```js
console.log(a);    // f a() {console.log(10)}
console.log(a());    //  10

var a = 3;
function a() {
  return 10
}
console.log(a)   //3
console.log(a())  //a is not a function;


//ç­‰ä»·äº
function a() {
  return 10
}
var a
console.log(a)
console.log(a())
a = 3
console.log(a) 
console.log(a());

```

ç”±æ­¤å¯è§å‡½æ•°æå‡è¦æ¯”å˜é‡æå‡çš„ä¼˜å…ˆçº§è¦é«˜ä¸€äº›ï¼Œä¸”ä¸ä¼šè¢«å˜é‡å£°æ˜è¦†ç›–ï¼Œä½†æ˜¯ä¼šè¢«å˜é‡èµ‹å€¼ä¹‹åè¦†ç›–ã€‚

### ä¸ºä»€ä¹ˆè¦å¼•å…¥const let

è§£å†³å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸè€Œå¸¦æ¥çš„ä¸åˆç†çš„åœºæ™¯ã€‚

å˜é‡æå‡çš„ä¸€äº›å¥‡æ€ªé—®é¢˜ã€‚

ä¸»è¦ç‰¹ç‚¹

1. å…·æœ‰å—çº§ä½œç”¨åŸŸ
2. Temporal dead zoneï¼Œä¸èƒ½åœ¨å£°æ˜å‰ä½¿ç”¨
3. `let` å’Œ `const` ä½œç”¨åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯åè€…å£°æ˜çš„å˜é‡ä¸èƒ½å†æ¬¡èµ‹å€¼
4. `var` åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹å£°æ˜å˜é‡ä¼šå¯¼è‡´å˜é‡æŒ‚è½½åœ¨ `window` ä¸Šï¼Œå…¶ä»–ä¸¤è€…ä¸ä¼š



## åŸå‹ç»§æ‰¿å’Œ Class ç»§æ‰¿

å…ˆè¦ç†è§£newèµ·åˆ°çš„ä½œç”¨ï¼Œè§03JSåŸºç¡€3



new æ„é€ å‡½æ•°  -> å®ä¾‹ å®ä¾‹è‡ªåŠ¨ç»‘å®šåˆ°æ„é€ å‡½æ•°çš„.prototypeä¸Šï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å®ä¾‹.protoè¿›è¡Œè®¿é—®



åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæ„é€ å‡½æ•°ä¸»è¦ç”¨äºç»‘å®šå±æ€§ï¼ŒåŸå‹ä¸Šæ”¾å‡½æ•°(è¿™æ ·å°±ä¸ç”¨å…±ç”¨çš„æ–¹æ³•è¿˜è¦å„è‡ªåˆ›å»ºç©ºé—´äº†)

### åŸå‹ç»§æ‰¿ä¹‹ç»„åˆç»§æ‰¿ã€å¯„ç”Ÿç»„åˆç»§æ‰¿

**ç»„åˆç»§æ‰¿**

```js
function Parent(value) {
  this.val = value
}
Parent.prototype.getValue = function() {
  console.log(this.val)
}
function Child(value) {
  Parent.call(this, value)
}
Child.prototype = new Parent()

const child = new Child(1)

child.getValue() // 1
child instanceof Parent // true
```

åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå†æŠŠå­ç±»æ„é€ å‡½æ•°çš„åŸå‹èµ‹å€¼ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°çš„å®ä¾‹å¯¹è±¡åœ¨åˆ¤æ–­ child instance of Parentä¸­ï¼Œchild.protp.proto === Parent.prototype

ç¼ºç‚¹æ˜¯å› ä¸ºæ˜¯ç”¨å®ä¾‹ä½œä¸ºæ¡¥æ¢ï¼Œç»§æ‰¿çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¼è‡´å­ç±»åŸå‹ä¸Šå¤šäº†ä¸éœ€è¦çš„çˆ¶ç±»çš„å±æ€§ï¼Œå­˜åœ¨å†…å­˜ä¸Šçš„æµªè´¹

![image-20200508110156851](http://picbed.sedationh.cn/image-20200508110156851.png)

åœ¨ç†è§£çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç–‘é—®

`child instanceof Child`ä¸ºä»€ä¹ˆæˆç«‹ï¼Œæ³¨æ„æˆ‘ä»¬ä¿®æ”¹äº†Childçš„prototype

`instanceof`çš„åŸç†æ˜¯

> åˆ¤æ–­left.proto === right.prototype
>
> å¦‚æœfalse left = left.proto é€šè¿‡ åŸå‹é“¾éå†ç›´åˆ°null

![image-20200508105318137](http://picbed.sedationh.cn/image-20200508105318137.png)

**å¯„ç”Ÿç»„åˆç»§æ‰¿**

```js
function Parent(value) {
  this.val = value
}
Parent.prototype.getValue = function() {
  console.log(this.val)
}

function Child(value) {
  Parent.call(this, value)
}
Child.prototype = Object.create(Parent.prototype, {
  constructor: {
    value: Child,
    enumerable: false,
    writable: true,
    configurable: true
  }
})

const child = new Child(1)

child.getValue() // 1
child instanceof Parent // true
```

å› ä¸ºç»„åˆç»§æ‰¿çš„ç¼ºç‚¹åœ¨äºç»§æ‰¿çˆ¶ç±»å‡½æ•°æ—¶å€™ï¼ˆé‡æ–°èµ‹å€¼å­ç±»åŸå‹å¯¹è±¡çš„æ—¶å€™ï¼‰ä½¿ç”¨å®ä¾‹ä½œä¸ºæ¡¥æ¢ï¼Œè°ƒç”¨äº†çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œäº§ç”Ÿäº†ä¸éœ€è¦çš„å˜é‡

So æˆ‘ä»¬å°±ç”¨çˆ¶ç±»æ„é€ å‡½æ•°çš„åŸå‹å°±å¥½äº†

ä»¥ä¸Šç»§æ‰¿å®ç°çš„æ ¸å¿ƒå°±æ˜¯å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™äº†å­ç±»ï¼Œå¹¶ä¸”å°†æ„é€ å‡½æ•°è®¾ç½®ä¸ºå­ç±»ï¼Œè¿™æ ·æ—¢è§£å†³äº†æ— ç”¨çš„çˆ¶ç±»å±æ€§é—®é¢˜ï¼Œè¿˜èƒ½æ­£ç¡®çš„æ‰¾åˆ°å­ç±»çš„æ„é€ å‡½æ•°ã€‚

![image-20200508110505108](http://picbed.sedationh.cn/image-20200508110505108.png)



### Classç»§æ‰¿

classåªæ˜¯è¯­æ³•ç³–ï¼Œåªæ˜¯å¯¹åŸå‹æ–¹æ¡ˆçš„å°è£…,classçš„æœ¬è´¨æ˜¯å‡½æ•°

[å‚çœ‹](https://segmentfault.com/a/1190000008338987)

```js
class Parent {
  constructor(value) {
    this.val = value
  }
  getValue() {
    console.log(this.val)
  }
}
class Child extends Parent {
  constructor(value) {
    // super() æŒ‡çš„æ˜¯è°ƒç”¨çˆ¶ç±»
    // è°ƒç”¨çš„åŒæ—¶ï¼Œä¼šç»‘å®š this ã€‚
    // ç›¸å½“äºParent.call(this, value)
    super(value)
    this.val = value
  }
}
let child = new Child(1)
child.getValue() // 1
child instanceof Parent // true
```



## æ¨¡å—åŒ–

[å‚çœ‹](https://juejin.im/post/5c17ad756fb9a049ff4e0a62#heading-38)

[ğŸ”—2](https://juejin.im/post/5eaacd175188256d4345ea3a)

1. ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–ï¼Ÿ

- å°†ä¸€ä¸ªå¤æ‚çš„ç¨‹åºä¾æ®ä¸€å®šçš„è§„åˆ™(è§„èŒƒ)å°è£…æˆå‡ ä¸ªå—(æ–‡ä»¶), å¹¶è¿›è¡Œç»„åˆåœ¨ä¸€èµ·
- å—çš„å†…éƒ¨æ•°æ®ä¸å®ç°æ˜¯ç§æœ‰çš„, åªæ˜¯å‘å¤–éƒ¨æš´éœ²ä¸€äº›æ¥å£(æ–¹æ³•)ä¸å¤–éƒ¨å…¶å®ƒæ¨¡å—é€šä¿¡

2. æ¨¡å—åŒ–è§£å†³äº†ä»€ä¹ˆï¼Ÿ

- é¿å…å‘½åå†²çª(å‡å°‘å‘½åç©ºé—´æ±¡æŸ“)
- æ›´å¥½çš„åˆ†ç¦», æŒ‰éœ€åŠ è½½
- æ›´é«˜å¤ç”¨æ€§
- é«˜å¯ç»´æŠ¤æ€§

3. æ€ä¹ˆè¿›è¡Œæ¨¡å—åŒ–ï¼Ÿ
   1. å…¨å±€function
   2. namespace
   3. IIFE
   4. CommonJS
   5. ES6

### IIFE(Immediately Invoked Function Expression)

åˆ©ç”¨å‡½æ•°é—­åŒ…

```js
var module1 = (function() {
    var _sum = 0;
    var foo1 = function () {};
    var foo2 = function () {};
    return {
      foo1: foo1,
      foo2: foo2
    }
  })();

```



### CommonJS

Nodeä½¿ç”¨çš„ä¸»è¦æ˜¯CommonJSè§„èŒƒ



ç‰¹ç‚¹ï¼š

- æ‰€æœ‰ä»£ç éƒ½è¿è¡Œåœ¨æ¨¡å—ä½œç”¨åŸŸï¼Œä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼›
- æ¨¡å—æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œå³åªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡Œåé¢çš„æ“ä½œï¼›
- æ¨¡å—åœ¨é¦–æ¬¡æ‰§è¡Œåå°±ä¼šç¼“å­˜ï¼Œå†æ¬¡åŠ è½½åªè¿”å›ç¼“å­˜ç»“æœï¼Œå¦‚æœæƒ³è¦å†æ¬¡æ‰§è¡Œï¼Œå¯æ¸…é™¤ç¼“å­˜ï¼›
- CommonJSè¾“å‡ºæ˜¯å€¼çš„æ‹·è´(å³ï¼Œ`require`è¿”å›çš„å€¼æ˜¯è¢«è¾“å‡ºçš„å€¼çš„æ‹·è´ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–ä¹Ÿä¸ä¼šå½±å“è¿™ä¸ªå€¼)ã€‚âš ï¸å¼•ç”¨ç±»å‹çš„ç‰¹æ®Šæ€§



åœ¨ä¸€ä¸ªnodeæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šç»™è¿™ä¸ªæ–‡ä»¶å†…ç”Ÿæˆä¸€ä¸ª `exports`å’Œ`module`å¯¹è±¡ï¼Œ è€Œ`module`åˆæœ‰ä¸€ä¸ª`exports`å±æ€§ã€‚

ç›¸å…³å®ç°é€»è¾‘å¦‚ä¸‹

```js
let module = {
  exports: {}
}
let exports = module.exports
```

åœ¨æˆ‘ä»¬requireçš„æ—¶å€™

```js
const a = require('./a')
// ç›¸å½“äº moduleæ˜¯æ¥è‡ªæ–‡ä»¶çš„
a = module.exports
// æ‰€ä»¥ï¼Œæ–‡ä»¶ä¸­è‡ªåŠ¨ç”Ÿæˆçš„exportsåªæ˜¯ç”¨äºè¾…åŠ©module.exports
// çœŸæ­£ç”¨äºå¯¼å‡ºå†…å®¹çš„ï¼Œè¿˜æ˜¯module.exports
```

### ES Module

```js
// å¼•å…¥æ¨¡å— API
import XXX from './a.js'
import { XXX } from './a.js'
// å¯¼å‡ºæ¨¡å— API
export function a() {}
export default function() {}
```

å†…å®¹æœ‰ç‚¹æ‚ï¼Œçœ‹æ–‡ç« å§