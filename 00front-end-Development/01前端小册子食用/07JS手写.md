# JSæ‰‹å†™ç³»åˆ—ğŸ‘‹

å…ˆè¦çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç”¨ï¼Œå†å»å®ç°



## call apply

The `all()` method calls a function with a given `this` value and arguments provided individually.

> **Note:** While the syntax of this function is almost identical to that of `apply()`, the fundamental difference is that `call()` accepts an **argument list**, while `apply()` accepts a **single array of arguments**.

ç®€å•æ¥è¯´ callå’Œapplyéƒ½ç”¨æ¥æ”¹å˜æ‰§è¡Œå‡½æ•°æ—¶å€™å‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘ï¼ŒåŒºåˆ«åœ¨äºå‚æ•°

å‡è®¾æœ‰ obj = {}  arr = [arg1,arg2]

ä½¿ç”¨call -> fn.call(obj,...arr)

ä½¿ç”¨apply -> fn.apply(obj,arr)



[å‚è€ƒ](https://github.com/mqyqingfeng/Blog/issues/11)

å®ç°é€»è¾‘

1. å°†å‡½æ•°è®¾ä¸ºå¯¹è±¡çš„å±æ€§
2. æ‰§è¡Œå‡½æ•°
3. åˆ é™¤å‡½æ•°



**`arguments`** is an `Array`-like object accessible inside [functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions) that contains the values of the arguments passed to that function.

> **Note:** â€œArray-likeâ€ means that `arguments` has a [`length`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/length) property and properties indexed from zero, but it doesn't have [`Array`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)'s built-in methods like [`forEach()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach) and [`map()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map). See [Â§Description](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments#Description) for details.

The `Array.from()` method creates a new, shallow-copied `Array` instance from an array-like or iterable object.



```js
Function.prototype.call = function (obj) {
  if (typeof this !== 'function') {
    throw new TypeError('Error')
  }
  obj = obj || window
  // å½“å‰æ‰§è¡Œçš„å‡½æ•°ä¸ºthis ã€å‚çœ‹this obj.fn() fnä¸­çš„thiså°±æ˜¯objã€‘
  obj.fn = this
  // å»é™¤æ‰objå‚æ•°ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯æ‰§è¡Œå‡½æ•°æ‰€éœ€è¦çš„
  // res is The result of calling the function 
  // with the specified this value and arguments.
  let res = obj.fn(...Array.from(arguments).slice(1))
  delete obj.fn
  return res
}

Function.prototype.apply = function (obj) {
  if (typeof this !== 'function') {
    throw TypeError('Error')
  }
  obj = obj || window
  obj.fn = this
  let res
  if (obj) {
    res = obj.fn(...arguments[1])
  } else {
    res = obj.fn()
  }
  return res
}

```



## bind

## Syntax

```
let boundFunc = func.bind(thisArg[, arg1[, arg2[, ...argN]]])
```

### Parameters



- `thisArg`

  The value to be passed as the `this` parameter to the target function `func` when the bound function is called. The value is ignored if the bound function is constructed using the new operator. When using `bind` to create a function (supplied as a callback) inside a `setTimeout`, any primitive value passed as `thisArg` is converted to object. If no arguments are provided to `bind`, the `this` of the executing scope is treated as the `thisArg` for the new function.

- `arg1, arg2, ...argN` Optional

  Arguments to prepend to arguments provided to the bound function when invoking `func`.

### Return value



A copy of the given function with the specified `this` value, and initial arguments (if provided).



obj = {}

function fn(){}

bindFn = fn.bind(obj,a,b)

bindFn(c) ç­‰ä»·äº fn.call(obj,a,b,c)



```js
Function.prototype.bind = function (obj) {
  if (typeof this !== 'function') {
    throw new TypeError('Error')
  }
  const _this = this
  const args = [...arguments].slice(1)
  // è¿”å›å‡½æ•° ä¸ç«‹åˆ»æ‰§è¡Œ
  return function F() {
    // é€šè¿‡new Con() è°ƒç”¨çš„è¯ objå¤±æ•ˆï¼Œ thisç»‘å®šåˆ°å®ä¾‹ä¸Š
    // new Con().bind() new Con()ä»£ç æ‰§è¡Œï¼Œè¿”å›å®ä¾‹ instanceof è¿™ä¸ªå®ä¾‹
    if (this instanceof F) {
      return new _this(...args, ...arguments)
    } else {
      return _this.apply(obj, args.concat(...arguments))
    }
  }
}
```

```html
/*
 ä¸‹é¢è¿™ä¸€è¡Œä¸èƒ½æ‰§è¡Œ
  new å§åé¢æ•´ä¸ªç©æ„çœ‹ä½œæ„é€ å‡½æ•° Con.bind å†…éƒ¨çš„thisæ˜¯ä¸ªå¯¹è±¡
*/
new Con.bind(bar) // ConÂ {age: "10"} false
```



![image-20200523134212015](http://picbed.sedationh.cn/image-20200523134212015.png)

æ›´å¤šç ”ç©¶å‚è€ƒ [./bindæµ‹è¯•.html](https://github.com/SedationH/web-roam/blob/master/003%E5%89%8D%E7%AB%AF%E5%B0%8F%E5%86%8C%E5%AD%90%E9%A3%9F%E7%94%A8/bind%E6%B5%8B%E8%AF%95.html) è¿›è¡ŒæŸ¥çœ‹



## newåŸç†

[æ˜é‡‘-é‡å­¦ JS ç³»åˆ—ï¼šèŠèŠ new æ“ä½œç¬¦](https://juejin.im/post/5c7b963ae51d453eb173896e)

å…ˆè¦æ™“å¾—newæ“ä½œç¬¦çš„ä½œç”¨

1. è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ„é€ å‡½æ•°ä¸Šçš„thisè¢«å›ºå®šåˆ°è¿™ä¸ªå¯¹è±¡ï¼ˆå®ä¾‹ï¼‰ä¸Š
2. æ„é€ å‡½æ•°è¿”å›primitiveå¿½ç•¥ï¼Œè‹¥è¿”å›å¯¹è±¡åˆ™éœ€è¿›è¡Œå¤„ç†
3. åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ï¼ˆå®ä¾‹ï¼‰èƒ½å¤Ÿè®¿é—®åˆ°æ„é€ å‡½æ•°çš„prototype



```js
function myNew(Con, ...arg) {
  // Con æ˜¯æ„é€ å‡½æ•°
  const obj = {}
  // ä½¿ç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡
  const result = Con.apply(obj, arg)
  // å°†æ„é€ å‡½æ•°çš„prototypeç»‘å®šåˆ°åˆ›å»ºçš„å¯¹è±¡ä¸Š
  Object.setPrototypeOf(obj, Con.prototype)
  // ç»æµ‹è¯•ï¼Œå¦‚æœæ„é€ å‡½æ•°çš„è¿”å›å€¼å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°±ä¼šè¿”å›æ„é€ å‡½æ•°ä¸­æŒ‡å®šçš„è¿”å›å€¼
  return result instanceof Object ? result : obj
}
function Foo(name, age) {
  this.name = name
  this.age = age
}
Foo.prototype.showInfo = function () {
  console.log(`name: ${this.name}\nage: ${this.age}`)
}
const foo = myNew(Foo, 'SedationH', '21')
foo.showInfo()
// name: SedationH
// age: 20
```



## æµ…è°ˆ instanceof å’Œ typeof çš„å®ç°åŸç†

[æµ…è°ˆ instanceof å’Œ typeof çš„å®ç°åŸç†](https://juejin.im/post/5b0b9b9051882515773ae714)

```js
function new_instance_of(leftVaule, rightVaule) { 
    let rightProto = rightVaule.prototype // å–å³è¡¨è¾¾å¼çš„ prototype å€¼
    leftVaule = leftVaule.__proto__ // å–å·¦è¡¨è¾¾å¼çš„__proto__å€¼
    while (true) {
    	if (leftVaule === null) {
            return false
        }
        if (leftVaule === rightProto) {
            return true
        } 
        leftVaule = leftVaule.__proto__ 
    }
}
```

<img src="http://picbed.sedationh.cn/image-20200507115911376.png" alt="image-20200507115911376" style="zoom:50%;" />



## ä¸ºä»€ä¹ˆ 0.1 + 0.2 != 0.3

[å‚çœ‹1](https://blog.huoding.com/2019/08/23/769)

[å‚çœ‹2](https://juejin.im/post/5b90e00e6fb9a05cf9080dff)

[å‚çœ‹3](https://segmentfault.com/a/1190000012175422)

é—®é¢˜çš„æ ¹æœ¬åœ¨äºè®¡ç®—æœºåº•å±‚è®°å½•æ•°æ®æ˜¯äºŒè¿›åˆ¶å½¢å¼

åœ¨æœ‰é™çš„è®°ä½é™åˆ¶ä¸­ï¼ˆNumberä½¿ç”¨64ä½åŒç²¾åº¦è®°å½•ï¼‰ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤º0.1

> å¦‚ä½•æ±‚0.1å¯¹åº”è€ŒäºŒè¿›åˆ¶è¡¨ç¤º
>
> â€‹	 è¿ç»­*2å–ä¸ªä½ï¼ˆé0å³è®°ä½1ï¼‰



![image-20200525230400613](http://picbed.sedationh.cn/image-20200525230400613.png)

æ—¢ç„¶è¯´åˆ°è¿™é‡Œï¼Œå†ç»™å¤§å®¶ç§‘æ™®ä¸€ä¸ªå°çŸ¥è¯†ç‚¹ï¼šjsæœ€å¤§å®‰å…¨æ•°æ˜¯ **Number.MAX_SAFE_INTEGER == Math.pow(2,53) - 1, è€Œä¸æ˜¯Math.pow(2,52) - 1, whyï¼Ÿå°¾æ•°éƒ¨åˆ†ä¸æ˜¯åªæœ‰52ä½å—?**

è¿™æ˜¯å› ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºæœ‰æ•ˆæ•°å­—æ€»æ˜¯1.xxâ€¦xxçš„å½¢å¼ï¼Œå°¾æ•°éƒ¨åˆ†fåœ¨è§„çº¦å½¢å¼ä¸‹ç¬¬ä¸€ä½é»˜è®¤ä¸º1ï¼ˆçœç•¥ä¸å†™ï¼Œxx..xxä¸ºå°¾æ•°éƒ¨åˆ†fï¼Œæœ€é•¿52ä½ï¼‰ã€‚å› æ­¤ï¼ŒJavaScriptæä¾›çš„æœ‰æ•ˆæ•°å­—æœ€é•¿ä¸º53ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆ64ä½æµ®ç‚¹çš„å52ä½+è¢«çœç•¥çš„1ä½ï¼‰

**JavaScriptå®éªŒï¼šæ•°å€¼èŒƒå›´**

å¯¹äºæ•´æ•°ï¼Œæ ¹æ®[ECMAScriptæ ‡å‡†çš„è¦æ±‚](http://ecma262-5.com/ELS5_HTML.htm#Section_8.5)ï¼ŒJavaScriptèƒ½è¡¨ç¤ºå¹¶è¿›è¡Œç²¾ç¡®ç®—æœ¯è¿ç®—çš„æ•´æ•°èŒƒå›´ä¸ºï¼šæ­£è´Ÿ2çš„53æ¬¡æ–¹ï¼Œä¹Ÿå³ä»æœ€å°å€¼-9007199254740992åˆ°æœ€å¤§å€¼+9007199254740992ä¹‹é—´çš„èŒƒå›´ï¼›å¯¹äºè¶…è¿‡è¿™ä¸ªèŒƒå›´çš„æ•´æ•°ï¼ŒJavaScriptä¾æ—§å¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä½†å´ä¸ä¿è¯è¿ç®—ç»“æœçš„ç²¾åº¦ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºæ•´æ•°çš„ä½è¿ç®—ï¼ˆæ¯”å¦‚ç§»ä½ç­‰æ“ä½œï¼‰ï¼ŒJavaScriptä»…æ”¯æŒ32ä½æ•´å‹æ•°ï¼Œä¹Ÿå³ä»-2147483648åˆ°+2147483647ä¹‹é—´çš„æ•´æ•°ã€‚

**0.1 + 0.1 ä¸ºä»€ä¹ˆç­‰äº0.2**

ç­”æ¡ˆæ˜¯ï¼šä¸¤ä¸ªæœ‰èˆå…¥è¯¯å·®çš„å€¼åœ¨æ±‚å’Œæ—¶ï¼Œç›¸äº’æŠµæ¶ˆäº†ï¼Œä½†è¿™ç§â€œè´Ÿè´Ÿå¾—æ­£ï¼Œç›¸äº’æŠµæ¶ˆâ€ä¸ä¸€å®šæ˜¯å¯é çš„ï¼Œå½“è¿™ä¸¤ä¸ªæ•°å­—æ˜¯ç”¨ä¸åŒé•¿åº¦æ•°ä½æ¥è¡¨ç¤ºçš„æµ®ç‚¹æ•°æ—¶ï¼Œèˆå…¥è¯¯å·®å¯èƒ½ä¸ä¼šç›¸äº’æŠµæ¶ˆã€‚

åˆå¦‚ï¼Œå¯¹äº 0.1 + 0.3 ï¼Œç»“æœå…¶å®å¹¶ä¸æ˜¯0.4ï¼Œä½†0.4æ˜¯æœ€æ¥è¿‘çœŸå®ç»“æœçš„æ•°ï¼Œæ¯”å…¶å®ƒä»»ä½•æµ®ç‚¹æ•°éƒ½æ›´æ¥è¿‘ã€‚è®¸å¤šè¯­è¨€ä¹Ÿå°±ç›´æ¥æ˜¾ç¤ºç»“æœä¸º0.4äº†ï¼Œè€Œä¸å±•ç¤ºä¸€ä¸ªæµ®ç‚¹æ•°çš„çœŸå®ç»“æœäº†ã€‚

å¦å¤–è¦æ³¨æ„ï¼Œ**äºŒè¿›åˆ¶èƒ½ç²¾ç¡®åœ°è¡¨ç¤ºä½æ•°æœ‰é™ä¸”åˆ†æ¯æ˜¯2çš„å€æ•°çš„å°æ•°**ï¼Œæ¯”å¦‚0.5ï¼Œ0.5åœ¨è®¡ç®—æœºå†…éƒ¨å°±æ²¡æœ‰èˆå…¥è¯¯å·®ã€‚æ‰€ä»¥0.5 + 0.5 === 1

